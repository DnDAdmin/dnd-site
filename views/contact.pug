extends layout

block head
  title= title + 'Contact Form'

block content
  div(class='row mt-5')
    div(class='col-12 col-md-8 mx-auto')
      if success 
        div#formMessage(class='success mb-2')
            h4 Success! 
            p Your message has been sent!
      else
        div#formMessage(class='mb-2')
            h4
            ul
      div(class='siteCont')
        h1(class='headingText text-center') Contact Form
        hr
        p(class='text-right')
            span(style='color: red;') *
            |  = required
        form#form(class='formMain mx-auto' action='/forms/contact'  method='post' enctype="multipart/form-data" onsubmit='return checkForErrors()')
          div(class='formItem')
            p(class='formLabel') Your Name:
              span  *
            input#name(class='formTextInput' type='text' data-req='true' name='name' placeholder='ext. John Doe' tabindex='1')
          
          div(class='formItem')
            p(class='formLabel') Your Email:
              span  *
            input#email(class='formTextInput' type='text' data-req='true' name='email' placeholder='ext. johndoe@site.com' tabindex='2')
          
          div(class='formItem')
            p(class='formLabel') Message:
              span  *
            div#editor-container(data-name='details' data-placeHolder='Say what you need to say.' data-tab=3 class='richEdit')
            input#details(style='display: none;' data-req='true' type='text' name='details')
          
          div(class='formItem text-right my-4')
            button#formButton(class='buttonMain button great col-12 col-md-4' onclick="sendMessage(); return false")
              div(class='buttonText mx-2')
                p Submit
    
      div(class='mt-2')
        ul#errorText(class='w-100 px-3 mx-auto errorText' style='display: none;')


  
  script.
    async function sendMessage() {
      await updateInput()
      var formMessage = document.getElementById('formMessage')
      
      var errors = await checkForErrors()
      if(errors) {
        formMessage.children[1].innerHTML = ''
        formMessage.classList.add('error')
        formMessage.children[0].innerHTML = 'Oops...'
        for(var i = 0; i< errors.length; i ++) {
            err = errors[i]
            var li = document.createElement('LI')
            li.innerHTML = err
            formMessage.children[1].appendChild(li)
        }
        window.scrollTo(0, 0);
      } else {
        document.getElementById('form').submit()
      }
    }


